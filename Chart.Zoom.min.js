/*!
 * Chart.Zoom.js
 * http://chartjs.org/
 * Version: 0.2.0
 *
 * Copyright 2016 Evert Timberg
 * Released under the MIT license
 * https://github.com/chartjs/Chart.Zoom.js/blob/master/LICENSE.md
 */
!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){},{}],2:[function(a,b,c){function k(a,b){return void 0===a||"string"==typeof a&&a.indexOf(b)!==-1}function l(a,b,c){}function m(a,b,c){var e,f,d=a.options;a.isHorizontal()?(e=a.right-a.left,f=(c.x-a.left)/e):(e=a.bottom-a.top,f=(c.y-a.top)/e);var g=1-f,h=e*(b-1),i=h*f,j=h*g;d.time.min=a.getValueForPixel(a.getPixelForValue(a.firstTick)+i),d.time.max=a.getValueForPixel(a.getPixelForValue(a.lastTick)-j)}function n(a,b,c){var d=a.max-a.min,e=d*(b-1),f=a.isHorizontal()?c.x:c.y,g=(a.getValueForPixel(f)-a.min)/d,h=1-g,i=e*g,j=e*h;a.options.ticks.min=a.min+i,a.options.ticks.max=a.max-j}function o(a,b,c){var d=h[a.options.type];d&&d(a,b,c)}function p(a,b,c){var d=a.chartArea;c||(c={x:(d.left+d.right)/2,y:(d.top+d.bottom)/2});var e=a.options.zoom;if(e&&f.getValueOrDefault(e.enabled,j.zoom.enabled)){var g=f.getValueOrDefault(a.options.zoom.mode,j.zoom.mode);f.each(a.scales,function(a,d){a.isHorizontal()&&k(g,"x")?o(a,b,c):k(g,"y")&&o(a,b,c)}),a.update(0)}}function q(a,b,c){var k,d=a.chart.data.labels,e=d.length-1,f=Math.max(a.ticks.length-(a.options.gridLines.offsetGridLines?0:1),1),h=c.speed,i=a.minIndex,j=Math.round(a.width/(f*h));g.panCumulativeDelta+=b,i=g.panCumulativeDelta>j?Math.max(0,i-1):g.panCumulativeDelta<-j?Math.min(e-f+1,i+1):i,g.panCumulativeDelta=i!==a.minIndex?0:g.panCumulativeDelta,k=Math.min(e,i+f-1),a.options.ticks.min=d[i],a.options.ticks.max=d[k]}function r(a,b){var c=a.options;c.time.min=a.getValueForPixel(a.getPixelForValue(a.firstTick)-b),c.time.max=a.getValueForPixel(a.getPixelForValue(a.lastTick)-b)}function s(a,b){var c=a.options.ticks,d=a.start,e=a.end;c.reverse?(c.max=a.getValueForPixel(a.getPixelForValue(d)-b),c.min=a.getValueForPixel(a.getPixelForValue(e)-b)):(c.min=a.getValueForPixel(a.getPixelForValue(d)-b),c.max=a.getValueForPixel(a.getPixelForValue(e)-b))}function t(a,b,c){var d=i[a.options.type];d&&d(a,b,c)}function u(a,b,c){var d=a.options.pan;if(d&&f.getValueOrDefault(d.enabled,j.pan.enabled)){var e=f.getValueOrDefault(a.options.pan.mode,j.pan.mode);d.speed=f.getValueOrDefault(a.options.pan.speed,j.pan.speed),f.each(a.scales,function(a,f){a.isHorizontal()&&k(e,"x")&&0!==b?t(a,b,d):!a.isHorizontal()&&k(e,"y")&&0!==c&&t(a,c)}),a.update(0)}}function w(a){var b=a.scales;for(var c in b){var d=b[c];if(!d.isHorizontal())return d}}var d=a("hammerjs");d="function"==typeof d?d:window.Hammer;var e=a("chart.js");e="function"==typeof e?e:window.Chart;var f=e.helpers,g=e.Zoom=e.Zoom||{},h=g.zoomFunctions=g.zoomFunctions||{},i=g.panFunctions=g.panFunctions||{},j=g.defaults={pan:{enabled:!0,mode:"xy",speed:20,threshold:10},zoom:{enabled:!0,mode:"xy"}};g.zoomFunctions.category=l,g.zoomFunctions.time=m,g.zoomFunctions.linear=n,g.zoomFunctions.logarithmic=n,g.panFunctions.category=q,g.panFunctions.time=r,g.panFunctions.linear=s,g.panFunctions.logarithmic=s,g.panCumulativeDelta=0;var x={afterInit:function(a){f.each(a.scales,function(a){a.originalOptions=JSON.parse(JSON.stringify(a.options))}),a.resetZoom=function(){f.each(a.scales,function(a,b){var c=a.options.time,d=a.options.ticks;c&&(delete c.min,delete c.max),d&&(delete d.min,delete d.max),a.options=f.configMerge(a.options,a.originalOptions)}),f.each(a.data.datasets,function(a,b){a._meta=null}),a.update()}},beforeInit:function(a){var b=a.chart.ctx.canvas,c=a.options,e=f.getValueOrDefault(c.pan?c.pan.threshold:void 0,g.defaults.pan.threshold);if(c.zoom.drag)c.zoom.mode="x",b.addEventListener("mousedown",function(b){a._dragZoomStart=b}),b.addEventListener("mousemove",function(b){a._dragZoomStart&&(a._dragZoomEnd=b,a.update(0)),a.update(0)}),b.addEventListener("mouseup",function(b){if(a._dragZoomStart){var c=a.chartArea,d=w(a),e=a._dragZoomStart,f=e.target.getBoundingClientRect().left,g=Math.min(e.x,b.x)-f,h=Math.max(e.x,b.x)-f,i=h-g,j=c.right-c.left,k=1+(j-i)/j;i>0&&p(a,k,{x:i/2+g,y:(d.bottom-d.top)/2}),a._dragZoomStart=null,a._dragZoomEnd=null}});else{var h=function(b){var c=b.target.getBoundingClientRect(),d=b.clientX-c.left,e=b.clientY-c.top,f={x:d,y:e};b.deltaY<0?p(a,1.1,f):p(a,.909,f)};a._wheelHandler=h,b.addEventListener("wheel",h)}if(d){var i=new d.Manager(b);i.add(new d.Pinch),i.add(new d.Pan({threshold:e}));var j,k=function(c){var d=1/j*c.scale;p(a,d,c.center),j=c.scale};i.on("pinchstart",function(a){j=1}),i.on("pinch",k),i.on("pinchend",function(a){k(a),j=null});var l=null,m=null,n=function(c){if(null!==l&&null!==m){var d=c.deltaX-l,e=c.deltaY-m;l=c.deltaX,m=c.deltaY,u(a,d,e)}};i.on("panstart",function(a){l=0,m=0,n(a)}),i.on("panmove",n),i.on("panend",function(a){l=null,m=null,g.panCumulativeDelta=0}),a._mc=i}},beforeDatasetsDraw:function(a){var b=a.chart.ctx,c=a.chartArea;if(b.save(),b.beginPath(),a._dragZoomEnd){var d=w(a),e=a._dragZoomStart,f=a._dragZoomEnd,g=e.target.getBoundingClientRect().left,h=Math.min(e.x,f.x)-g,i=Math.max(e.x,f.x)-g,j=i-h;b.fillStyle="rgba(225,225,225,0.3)",b.lineWidth=5,b.fillRect(h,d.top,j,d.bottom-d.top)}b.rect(c.left,c.top,c.right-c.left,c.bottom-c.top),b.clip()},afterDatasetsDraw:function(a){a.chart.ctx.restore()},destroy:function(a){var b=a.chart.ctx.canvas;b.removeEventListener("wheel",a._wheelHandler);var c=a._mc;c&&(c.remove("pinchstart"),c.remove("pinch"),c.remove("pinchend"),c.remove("panstart"),c.remove("pan"),c.remove("panend"))}};e.pluginService.register(x)},{"chart.js":1,hammerjs:1}]},{},[2]);
